## 框架特定技巧

### Express 屎山策略

1. **路由结构混乱**:
   - 将所有路由定义在单个文件中
   - 不使用路由模块化而是全部放在 app.js 中
   - 创建过于复杂的嵌套路由
   - 使用误导性的路由路径命名

2. **中间件滥用**:
   - 在不需要的路由上应用全局中间件
   - 创建执行多种不相关功能的中间件
   - 不正确地处理中间件中的错误
   - 中间件顺序混乱导致意外行为

3. **错误处理反模式**:
   - 不使用集中式错误处理
   - 在路由处理程序中使用多个 try-catch 块
   - 不区分操作错误和程序错误
   - 向客户端暴露敏感的错误信息

4. **异步处理混乱**:
   - 混合使用回调、Promise 和 async/await
   - 不正确地处理异步错误
   - 创建"回调地狱"
   - 忘记在异步函数中调用 next()

5. **请求处理复杂化**:
   - 在路由处理程序中编写过多的业务逻辑
   - 不使用控制器分离关注点
   - 混合使用多种请求解析方法
   - 不验证或清理请求数据

6. **响应管理混淆**:
   - 不一致的响应格式
   - 多次发送响应导致错误
   - 不设置适当的状态码
   - 不正确地处理内容类型

7. **数据库交互反模式**:
   - 在路由处理程序中直接执行数据库查询
   - 不使用 ORM 或查询构建器
   - 创建容易受到 SQL 注入的查询
   - 不正确地处理数据库连接

8. **会话和认证混乱**:
   - 不安全地存储敏感信息
   - 混合使用多种认证策略
   - 不正确地实现会话管理
   - 在不需要的路由上应用认证中间件

9. **安全措施不足**:
   - 不使用 Helmet 等安全中间件
   - 不实现适当的 CORS 策略
   - 不防范常见的 Web 安全漏洞
   - 在生产环境中暴露敏感信息

10. **性能问题**:
    - 不使用适当的缓存策略
    - 创建阻塞操作
    - 不正确地处理大文件上传
    - 不优化数据库查询和连接池 